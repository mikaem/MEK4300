

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Suggested solutions Couette &#8212; MEK4300 Lecture notes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/sphinx-book-theme.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/mystnb.js"></script>
    <script src="../../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"]}, "extensions": ["cancel.js", "AMSmath.js"]}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Chapter 4" href="../chapter4/intro.html" />
    <link rel="prev" title="Chapter 3" href="intro.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
  
  <img src="../../../_static/uio_logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">MEK4300 Lecture notes</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  White - Viscous Fluid Flow
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../chapter3/intro.html">
   Chapter 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../chapter4/intro.html">
   Chapter 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../chapter6/turbulence.html">
   Chapter 6
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="../intro.html">
   Suggested solutions
  </a>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="reference internal" href="intro.html">
     Chapter 3
    </a>
    <ul class="current">
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Suggested solutions Couette
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter4/intro.html">
     Chapter 4
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  FEniCS
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../fenics/intro.html">
   FEniCS
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/content/solutions/chapter3/couette.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/mikaem/MEK4300"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/mikaem/MEK4300/master?urlpath=tree/content/solutions/chapter3/couette.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solutions-written-assignments-couette">
   Solutions written assignments Couette
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-3-1-in-white">
     Problem 3-1 in White
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-3-2-in-white">
     Problem 3-2 in White
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-3-3-in-white">
     Problem 3-3 in White
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-3-4-in-white">
     Problem 3-4 in White
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-3-5-in-white">
     Problem 3-5 in White
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#flow-between-rotating-concentric-cylinders">
     Flow between rotating concentric cylinders
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="suggested-solutions-couette">
<h1>Suggested solutions Couette<a class="headerlink" href="#suggested-solutions-couette" title="Permalink to this headline">¶</a></h1>
<div class="section" id="solutions-written-assignments-couette">
<h2>Solutions written assignments Couette<a class="headerlink" href="#solutions-written-assignments-couette" title="Permalink to this headline">¶</a></h2>
<div class="section" id="problem-3-1-in-white">
<h3>Problem 3-1 in White<a class="headerlink" href="#problem-3-1-in-white" title="Permalink to this headline">¶</a></h3>
<p>Solve for a non-Newtonian Couette flow, where the stress tensor is computed as</p>
<div class="math notranslate nohighlight">
\[
  \tau = K\left(\frac{\mathrm{d}u}{\mathrm{d}y}\right)^n,
\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> is an integer different from 1.
The momentum equation for any stress tensor in a Couette flow is</p>
<div class="math notranslate nohighlight">
\[
  0 = \nabla \cdot \tau.
\]</div>
<p>For one-dimensional Couette flow aligned with the <span class="math notranslate nohighlight">\(x\)</span>-direction and homogeneous in the <span class="math notranslate nohighlight">\(z\)</span>-direction, the equation reads</p>
<div class="math notranslate nohighlight">
\[
  0 = \frac{\mathrm{d} \tau}{\mathrm{d}y},
\]</div>
<p>which means that <span class="math notranslate nohighlight">\(\tau\)</span> is a constant with respect to <span class="math notranslate nohighlight">\(y\)</span> and thus</p>
<div class="math notranslate nohighlight">
\[
 K\left(\frac{\mathrm{d}u}{\mathrm{d}y}\right)^n = K_2,
\]</div>
<p>where <span class="math notranslate nohighlight">\(K_2\)</span> is a new constant. In other words</p>
<div class="math notranslate nohighlight">
\[
 \frac{\mathrm{d}u}{\mathrm{d}y} = K_3 \left(= (K_2/K)^{1/n}\right),
\]</div>
<p>and thus</p>
<div class="math notranslate nohighlight">
\[
 u = K_3 y + K_4.
\]</div>
<p>The solution is the same as for Newtonian flows regardless of <span class="math notranslate nohighlight">\(n\)</span>.</p>
</div>
<div class="section" id="problem-3-2-in-white">
<h3>Problem 3-2 in White<a class="headerlink" href="#problem-3-2-in-white" title="Permalink to this headline">¶</a></h3>
<p>The analytical solution has already been computed in Eq. <a class="reference internal" href="../../chapter3/couette.html#equation-eq-uaxcyl">(10)</a> in <a class="reference internal" href="../../chapter3/couette.html"><span class="doc std std-doc">Couette flows</span></a>.</p>
</div>
<div class="section" id="problem-3-3-in-white">
<h3>Problem 3-3 in White<a class="headerlink" href="#problem-3-3-in-white" title="Permalink to this headline">¶</a></h3>
<p>The temperature equation reduces to</p>
<div class="math notranslate nohighlight">
\[
 0 = \frac{\kappa}{r}\frac{\mathrm{d}}{\mathrm{d} r}\left(r \frac{\mathrm{d} T}{\mathrm{d} r} \right) + \mu \left(\frac{\mathrm{d} u_z}{\mathrm{d}r} \right)^2.
\]</div>
<p>Inserting for Eq. <a class="reference internal" href="../../chapter3/couette.html#equation-eq-uaxcyl">(10)</a> we have</p>
<div class="math notranslate nohighlight">
\[
 \frac{\mathrm{d}}{\mathrm{d} r}\left(r \frac{\mathrm{d} T}{\mathrm{d} r} \right) = -\frac{\mu U_0^2}{\kappa r \ln^2(r_1/r_0)}.
\]</div>
<p>Integrate twice to obtain</p>
<div class="math notranslate nohighlight">
\[
 T = -\frac{\mu U_0^2}{2 \kappa \ln^2(r_1/r_0)} \ln^2(r) + C_1\ln(r) + C_2,
\]</div>
<p>and determine constants using the two boundary conditions.</p>
</div>
<div class="section" id="problem-3-4-in-white">
<h3>Problem 3-4 in White<a class="headerlink" href="#problem-3-4-in-white" title="Permalink to this headline">¶</a></h3>
<p>The problem reads: solve the Laplace equation in cylindrical coordinates <a class="reference internal" href="../../chapter3/couette.html#equation-eq-poissoncyl">(8)</a> with boundary conditions <span class="math notranslate nohighlight">\(u(0)=U\)</span> and <span class="math notranslate nohighlight">\(u(\infty)=0\)</span>. The solution for the velocity is given in Eq. <a class="reference internal" href="../../chapter3/couette.html#equation-eq-ustep1">(9)</a> and inserted for the boundary conditions we need to find <span class="math notranslate nohighlight">\(C_1\)</span> and <span class="math notranslate nohighlight">\(C_2\)</span> such that</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
  u(0) = U &amp;= C_1 \ln(0) + C_2, \\
  u(\infty) = 0 &amp;= C_1 \ln(\infty) + C_2.
\end{aligned}
\end{split}\]</div>
<p>The first condition requires <span class="math notranslate nohighlight">\(C_1=0\)</span> and thus <span class="math notranslate nohighlight">\(C_2=U\)</span>. The second condition requires <span class="math notranslate nohighlight">\(C_2=0\)</span>, which is a contradiction. It is not possible to satisfy both boundary conditions. Physically, the boundary layer that is being dragged by the rod will continue to grow indefinitely and there is no steady state solution possible for this problem.</p>
</div>
<div class="section" id="problem-3-5-in-white">
<h3>Problem 3-5 in White<a class="headerlink" href="#problem-3-5-in-white" title="Permalink to this headline">¶</a></h3>
<p>Solve the momentum equation for the angular velocity</p>
<div class="math notranslate nohighlight">
\[
  \frac{\mathrm{d}^2 u_{\theta}}{\mathrm{d} r^2} + \frac{\mathrm{d} u_{\theta}/r}{\mathrm{d}r} = 0
  \label{eq:AngularVel}
\]</div>
<p>with boundary conditions <span class="math notranslate nohighlight">\(u(R)=\omega R\)</span> and <span class="math notranslate nohighlight">\(u(\infty)=0\)</span>. The solution to this equation is given by <a class="bibtex reference internal" href="../../chapter3/poiseuille.html#white06" id="id1">[Whi06]</a></p>
<div class="math notranslate nohighlight">
\[
  u_{\theta}(r) = C_1 r + \frac{C_2}{r}
\]</div>
<p>The boundary conditions are then</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
  u_{\theta}(R) = \omega R &amp;= C_1 R + \frac{C_2}{R}, \\
  u_{\theta}(\infty) = 0 &amp;= C_1 \infty + \frac{C_2}{\infty}
\end{aligned}
\end{split}\]</div>
<p>which leads to <span class="math notranslate nohighlight">\(C_1=0\)</span> and <span class="math notranslate nohighlight">\(C_2=\omega R^2\)</span> and thus the angular velocity</p>
<div class="math notranslate nohighlight">
\[
  u_{\theta} = \frac{\omega R^2}{r},
\]</div>
<p>which agrees with the solution of a potential vortex.
The pressure is found from the r-momentum equation</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
 \frac{\mathrm{d} p}{\mathrm{d} r} &amp;= \frac{\rho u_{\theta}^2}{r}, \\
 \frac{\mathrm{d} p}{\mathrm{d} r} &amp;= \frac{\rho \omega^2 R^4}{r^3}
\end{aligned}
\end{split}\]</div>
<p>which can be integrated to</p>
<div class="math notranslate nohighlight">
\[
 p(r) = -\frac{\rho \omega^2 R^4}{2 r^2} + C_1
\]</div>
<p>and where the constant can be found by assuming <span class="math notranslate nohighlight">\(p(R)=p_0\)</span> such that</p>
<div class="math notranslate nohighlight">
\[
 p(r) = p_0 + \frac{\rho \omega^2 R^2}{2}\left(1 - \frac{R^2}{r^2} \right),
\]</div>
<p>which is what we would find using Bernoulli’s equation for a potential vortex (<span class="math notranslate nohighlight">\(p_0+0.5\rho (\omega R)^2 = p + 0.5 \rho u^2\)</span>).</p>
</div>
<div class="section" id="flow-between-rotating-concentric-cylinders">
<h3>Flow between rotating concentric cylinders<a class="headerlink" href="#flow-between-rotating-concentric-cylinders" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Flow between rotating concentric cylinders</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">dolfin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="n">r0</span><span class="p">,</span> <span class="n">r1</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">IntervalMesh</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="n">r1</span><span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">TrialFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">TestFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Expression</span><span class="p">(</span><span class="s2">&quot;x[0]&quot;</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">w0</span><span class="p">,</span> <span class="n">w1</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">T0</span><span class="p">,</span> <span class="n">T1</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">Constant</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">k</span>  <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
<span class="n">u_</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">T_</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">F</span>  <span class="o">=</span> <span class="n">inner</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">dx</span> <span class="o">+</span> <span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="o">/</span><span class="n">x</span><span class="o">*</span><span class="n">dx</span>
<span class="n">FT</span> <span class="o">=</span> <span class="n">inner</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">dx</span> <span class="o">-</span> <span class="n">mu</span><span class="o">/</span><span class="n">k</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">u_</span><span class="o">.</span><span class="n">dx</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="n">u_</span><span class="o">/</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">dx</span>

<span class="k">def</span> <span class="nf">inner_bnd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_bnd</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">on_bnd</span> <span class="ow">and</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">r0</span><span class="o">+</span><span class="n">DOLFIN_EPS</span>

<span class="k">def</span> <span class="nf">outer_bnd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_bnd</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">on_bnd</span> <span class="ow">and</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="o">-</span><span class="n">DOLFIN_EPS</span>

<span class="n">bci</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">r0</span><span class="o">*</span><span class="n">w0</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;std::abs(x[0]-</span><span class="si">{}</span><span class="s2">) &lt; 1.e-12&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r0</span><span class="p">))</span>
<span class="n">bco</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">r1</span><span class="o">*</span><span class="n">w1</span><span class="p">,</span> <span class="n">outer_bnd</span><span class="p">)</span>
<span class="n">bcTi</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="n">inner_bnd</span><span class="p">)</span>
<span class="n">bcTo</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">T1</span><span class="p">,</span> <span class="n">outer_bnd</span><span class="p">)</span>

<span class="n">solve</span><span class="p">(</span><span class="n">lhs</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">==</span> <span class="n">rhs</span><span class="p">(</span><span class="n">F</span><span class="p">),</span> <span class="n">u_</span><span class="p">,</span> <span class="n">bcs</span><span class="o">=</span><span class="p">[</span><span class="n">bci</span><span class="p">,</span> <span class="n">bco</span><span class="p">])</span>
<span class="n">solve</span><span class="p">(</span><span class="n">lhs</span><span class="p">(</span><span class="n">FT</span><span class="p">)</span> <span class="o">==</span> <span class="n">rhs</span><span class="p">(</span><span class="n">FT</span><span class="p">),</span> <span class="n">T_</span><span class="p">,</span> <span class="n">bcs</span><span class="o">=</span><span class="p">[</span><span class="n">bcTi</span><span class="p">,</span> <span class="n">bcTo</span><span class="p">])</span>

<span class="c1"># Compute exact solution given in (3.22)</span>
<span class="n">ue</span> <span class="o">=</span> <span class="n">project</span><span class="p">(</span><span class="n">r0</span><span class="o">*</span><span class="n">w0</span><span class="o">*</span><span class="p">(</span><span class="n">r1</span><span class="o">/</span><span class="n">x</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="n">r1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">r1</span><span class="o">/</span><span class="n">r0</span><span class="o">-</span><span class="n">r0</span><span class="o">/</span><span class="n">r1</span><span class="p">)</span> <span class="o">+</span>
             <span class="n">r1</span><span class="o">*</span><span class="n">w1</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">r0</span><span class="o">-</span><span class="n">r0</span><span class="o">/</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">r1</span><span class="o">/</span><span class="n">r0</span><span class="o">-</span><span class="n">r0</span><span class="o">/</span><span class="n">r1</span><span class="p">),</span> <span class="n">V</span><span class="p">)</span>

<span class="c1"># Compute exact solution given in (3.23)</span>
<span class="n">Tn</span> <span class="o">=</span> <span class="n">project</span><span class="p">((</span><span class="n">T_</span><span class="o">-</span><span class="n">T0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">T1</span><span class="o">-</span><span class="n">T0</span><span class="p">),</span> <span class="n">V</span><span class="p">)</span>
<span class="n">PrEc</span> <span class="o">=</span> <span class="n">mu</span><span class="o">*</span><span class="n">r0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">w0</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">k</span><span class="o">/</span><span class="p">(</span><span class="n">T1</span><span class="o">-</span><span class="n">T0</span><span class="p">)</span>
<span class="n">Te</span> <span class="o">=</span> <span class="n">PrEc</span><span class="o">*</span><span class="n">r1</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="n">r1</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">r0</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">r0</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">r0</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">r1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ln</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">r0</span><span class="p">)</span><span class="o">/</span><span class="n">ln</span><span class="p">(</span><span class="n">r1</span><span class="o">/</span><span class="n">r0</span><span class="p">))</span> <span class="o">+</span> <span class="n">ln</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">r0</span><span class="p">)</span><span class="o">/</span><span class="n">ln</span><span class="p">(</span><span class="n">r1</span><span class="o">/</span><span class="n">r0</span><span class="p">)</span>
<span class="n">Te</span> <span class="o">=</span> <span class="n">project</span><span class="p">(</span><span class="n">Te</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Error velocity    = &quot;</span><span class="p">,</span> <span class="n">errornorm</span><span class="p">(</span><span class="n">u_</span><span class="p">,</span> <span class="n">ue</span><span class="p">,</span> <span class="n">degree_rise</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error temperature = &quot;</span><span class="p">,</span> <span class="n">errornorm</span><span class="p">(</span><span class="n">Tn</span><span class="p">,</span> <span class="n">Te</span><span class="p">,</span> <span class="n">degree_rise</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;??? Should be close to zero.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u_</span><span class="o">.</span><span class="n">vector</span><span class="p">()</span><span class="o">.</span><span class="n">get_local</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ue</span><span class="o">.</span><span class="n">vector</span><span class="p">()</span><span class="o">.</span><span class="n">get_local</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Angular velocity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;Computed&#39;</span><span class="p">,</span> <span class="s1">&#39;Exact&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Tn</span><span class="o">.</span><span class="n">vector</span><span class="p">()</span><span class="o">.</span><span class="n">get_local</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Te</span><span class="o">.</span><span class="n">vector</span><span class="p">()</span><span class="o">.</span><span class="n">get_local</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Temperature (?wrong?)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;Computed&#39;</span><span class="p">,</span> <span class="s1">&#39;Exact&#39;</span><span class="p">))</span>

<span class="c1"># Since I cannot reproduce the temperature I have recomputed</span>
<span class="c1"># (3.23) analytically. I plot that result here</span>
<span class="n">C1</span> <span class="o">=</span> <span class="n">w0</span><span class="o">-</span><span class="n">r1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">w1</span><span class="o">-</span><span class="n">w0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">r0</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">r1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">C2</span> <span class="o">=</span> <span class="n">r1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">w1</span><span class="o">-</span><span class="n">w0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">r1</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">r0</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">C3</span> <span class="o">=</span> <span class="p">(</span><span class="n">T1</span><span class="o">-</span><span class="n">T0</span><span class="o">+</span><span class="n">C2</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mu</span><span class="o">/</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">r1</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">r0</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">ln</span><span class="p">(</span><span class="n">r1</span><span class="o">/</span><span class="n">r0</span><span class="p">)</span>
<span class="n">C4</span> <span class="o">=</span> <span class="n">T0</span> <span class="o">+</span> <span class="n">C2</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mu</span><span class="o">/</span><span class="n">k</span><span class="o">/</span><span class="n">r0</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">C3</span><span class="o">*</span><span class="n">ln</span><span class="p">(</span><span class="n">r0</span><span class="p">)</span>
<span class="n">Tee</span> <span class="o">=</span> <span class="n">project</span><span class="p">((</span><span class="o">-</span><span class="n">C2</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">mu</span><span class="o">/</span><span class="n">k</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">C3</span><span class="o">*</span><span class="n">ln</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">C4</span><span class="o">-</span><span class="n">T0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">T1</span><span class="o">-</span><span class="n">T0</span><span class="p">),</span> <span class="n">V</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Error recomputed temperature = &quot;</span><span class="p">,</span> <span class="n">errornorm</span><span class="p">(</span><span class="n">Tn</span><span class="p">,</span> <span class="n">Tee</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Which is a strong indication that (3.23) is wrong!!&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>
Error velocity    =  1.1540847636407312e-05
Error temperature =  0.20666794167009878
??? Should be close to zero.


Error recomputed temperature =  0.000492714248321644
Which is a strong indication that (3.23) is wrong!!
</pre></div>
</div>
<img alt="../../../_images/couette_7_1.png" src="../../../_images/couette_7_1.png" />
<img alt="../../../_images/couette_7_2.png" src="../../../_images/couette_7_2.png" />
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "mikaem/MEK4300",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content/solutions/chapter3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">Chapter 3</a>
    <a class='right-next' id="next-link" href="../chapter4/intro.html" title="next page">Chapter 4</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Mikael Mortensen<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../../_static/js/index.js"></script>
    
  </body>
</html>