

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stokes flow &#8212; MEK4300 Lecture notes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"]}, "extensions": ["cancel.js", "AMSmath.js"]}})</script>
    <script async="async" src="https://unpkg.com/thebe-mikaem/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Chapter 4" href="../chapter4/intro.html" />
    <link rel="prev" title="Similarity solutions" href="similarity.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/uio_logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">MEK4300 Lecture notes</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  White - Viscous Fluid Flow
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="reference internal" href="intro.html">
   Chapter 3
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="planeshearflow.html">
     Parallel shear flows
    </a>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="couette.html">
       Couette flows
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="poiseuille.html">
       Poiseuille flows
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="similarity.html">
     Similarity solutions
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Stokes flow
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter4/intro.html">
   Chapter 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter6/turbulence.html">
   Chapter 6
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../solutions/intro.html">
   Suggested solutions
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  FEniCS
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../fenics/intro.html">
   FEniCS
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Mandatory assignments
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../mandatory/mandatory1.html">
   First mandatory assignments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mandatory/mandatory2.html">
   Second mandatory assignment
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/content/chapter3/stokes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/mikaem/MEK4300"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/mikaem/MEK4300/master?urlpath=tree/content/chapter3/stokes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creeping-flow-past-a-sphere">
   Creeping flow past a sphere
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="stokes-flow">
<h1>Stokes flow<a class="headerlink" href="#stokes-flow" title="Permalink to this headline">¶</a></h1>
<p>Flows at very low Reynolds numbers are often called <em>Stokes flow</em>. If the Navier-Stokes equations are nondimensionalized using the characteristic velocity <span class="math notranslate nohighlight">\(U\)</span> and length scale <span class="math notranslate nohighlight">\(L\)</span>, the equations can be simplified as</p>
<div class="math notranslate nohighlight" id="equation-eq-ns-nondim">
<span class="eqno">(46)<a class="headerlink" href="#equation-eq-ns-nondim" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
\mathrm{Re}\left(  \frac{\partial \boldsymbol{\tilde{u}}}{\partial \tilde{t}} + (\boldsymbol{\tilde{u}} \cdot \tilde{\nabla})\boldsymbol{\tilde{u}} \right) &amp;= -\tilde{\nabla} \tilde{p} + \tilde{\nabla} ^2 \boldsymbol{\tilde{u}}, \\
  \tilde{\nabla} \cdot \boldsymbol{\tilde{u}} &amp;= 0,
\end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{\tilde{u}} = \boldsymbol{u}/U\)</span>, <span class="math notranslate nohighlight">\(\tilde{t}=tU/L\)</span>, <span class="math notranslate nohighlight">\(\tilde{\boldsymbol{x}}=\boldsymbol{x}/L\)</span>, <span class="math notranslate nohighlight">\(\tilde{p}=p/(\mu U /L)\)</span> and <span class="math notranslate nohighlight">\(\mathrm{Re}=\rho U L / \mu\)</span>. The spatial derivative is taken with respect to <span class="math notranslate nohighlight">\(\tilde{\boldsymbol{x}}\)</span>, which explains the tilde on the nabla operator. The assumption for Stokes flow is that the Reynolds number is very small <span class="math notranslate nohighlight">\(\mathrm{Re} &lt;&lt; 1\)</span>, such that the acceleration term on the left hand side of Navier-Stokes can be neglected. Stokes flow is therefore governed, on dimensional form, by</p>
<div class="math notranslate nohighlight" id="equation-eq-stokes">
<span class="eqno">(47)<a class="headerlink" href="#equation-eq-stokes" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
\mu\nabla ^2 \boldsymbol{u} &amp;= {\nabla} {p} ,  \\
  {\nabla} \cdot \boldsymbol{u} &amp;= 0.
\end{aligned}\end{split}\]</div>
<p>Here the first (vector) equation is a momentum equation, whereas the second <span class="math notranslate nohighlight">\(\nabla \cdot \boldsymbol{u}\)</span> usually is referred to as the continuity eqaution.</p>
<p>Conveniently there is a <a class="reference external" href="https://fenicsproject.org/docs/dolfin/latest/python/demos/stokes-iterative/demo_stokes-iterative.py.html">FEniCS demo</a> available for solving the Stokes equations in a three-dimensional cubic
domain. In this demo the velocity and pressure are solved using a coupled
system of equations. That is, both equations in <a class="reference internal" href="#equation-eq-stokes">(47)</a>
are solved simultaneously as opposed to in a segregated, sequential manner.
Since the first equation in <a class="reference internal" href="#equation-eq-stokes">(47)</a> is a vector equation, this means that we are actually
solving 4 equations (if the domain is 3D) simultaneously. Both <span class="math notranslate nohighlight">\(\boldsymbol{u}\)</span> and <span class="math notranslate nohighlight">\(p\)</span>
are treated as unknowns (<code class="docutils literal notranslate"><span class="pre">TrialFunction</span></code>s) using a mixed (coupled) functionspace.</p>
<p>The variational formulation for the Stokes equations is found by multiplying the vector equation in <a class="reference internal" href="#equation-eq-stokes">(47)</a> with <code class="docutils literal notranslate"><span class="pre">TestFunction</span></code> <span class="math notranslate nohighlight">\(\boldsymbol{v}\)</span> and the continuity equation with <code class="docutils literal notranslate"><span class="pre">TestFunction</span></code> <span class="math notranslate nohighlight">\(q\)</span> and then integrating over the domain</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\mu\int_{\Omega} \boldsymbol{v} \cdot \nabla ^2 \boldsymbol{u}\, \mathrm{d}x &amp;=  \int_{\Omega} \boldsymbol{v} \cdot {\nabla} {p}\, \mathrm{d}x, \\
  \int_{\Omega} q \, {\nabla} \cdot \boldsymbol{u} \,\mathrm{d}x &amp;= 0.
\end{aligned}\end{split}\]</div>
<p>Both the Laplacian and pressure gradient are integrated by parts</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\mu \int_{\Gamma} \boldsymbol{v} \cdot (\nabla  \boldsymbol{u} \cdot \boldsymbol{n})\, \mathrm{d}s - \mu \int_{\Omega} \nabla \boldsymbol{v} : \nabla \boldsymbol{u}\, \mathrm{d}x &amp;= \int_{\Gamma} \boldsymbol{v} \cdot p\boldsymbol{n}\, \mathrm{d}s -\int_{\Omega} p\, \nabla \cdot \boldsymbol{v} \, \mathrm{d}x , \\
  \int_{\Omega} q\,  {\nabla} \cdot \boldsymbol{u} \,\mathrm{d}x &amp;= 0,
\end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{n}\)</span> is the normal vector out of the domain and the colon represents an inner product (contraction) of two second order tensors. The boundary integral can be written as</p>
<div class="math notranslate nohighlight">
\[  \int_{\Gamma} \boldsymbol{v} \cdot \left( p \boldsymbol{I} -\mu \nabla  \boldsymbol{u}  \right) \cdot \boldsymbol{n}\, \mathrm{d}s\]</div>
<p>and you should recognize <span class="math notranslate nohighlight">\(\left(p \boldsymbol{I} -\mu \nabla \boldsymbol{u} \right)\cdot \boldsymbol{n}\)</span> as part of the total stress <span class="math notranslate nohighlight">\(\tau=-p \boldsymbol{I}+\mu(\nabla \boldsymbol{u} + \nabla  \boldsymbol{u}^T)\)</span> acting on the surface with normal vector <span class="math notranslate nohighlight">\(\boldsymbol{n}\)</span>. In finite element communities the boundary condition <span class="math notranslate nohighlight">\(\left(p \boldsymbol{I} -\mu \nabla \boldsymbol{u} \right) \cdot \boldsymbol{n}=0\)</span> is called pseudo-traction or a do-nothing boundary condition. It is often used on outlets where we are simply interested in letting the fluid escape with as little interference of boundary conditions as possible. It is called do-noting because you don’t have to do anything to enforce it, just simply omit the boundary terms and solve the two equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
 \mu \int_{\Omega} \nabla \boldsymbol{v} : \nabla \boldsymbol{u}\, \mathrm{d}x -\int_{\Omega} p\, \nabla \cdot \boldsymbol{v} \, \mathrm{d}x &amp;= 0, \\
  \int_{\Omega} q\,  {\nabla} \cdot \boldsymbol{u} \,\mathrm{d}x &amp;= 0.
\end{aligned}\end{split}\]</div>
<p>In FEniCS we may set up these two equations (one vector and one scalar equation) to be solved in a coupled manner. The approach is given below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dolfin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="n">mesh</span> <span class="o">=</span> <span class="n">UnitSquareMesh</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># Build function space</span>
<span class="n">P2</span> <span class="o">=</span> <span class="n">VectorElement</span><span class="p">(</span><span class="s2">&quot;CG&quot;</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">ufl_cell</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">P1</span> <span class="o">=</span> <span class="n">FiniteElement</span><span class="p">(</span><span class="s2">&quot;CG&quot;</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">ufl_cell</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">TH</span> <span class="o">=</span> <span class="n">P2</span> <span class="o">*</span> <span class="n">P1</span>
<span class="n">VQ</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">TH</span><span class="p">)</span>
<span class="n">u</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">TrialFunctions</span><span class="p">(</span><span class="n">VQ</span><span class="p">)</span>
<span class="n">v</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">TestFunctions</span><span class="p">(</span><span class="n">VQ</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">mu</span><span class="o">*</span><span class="n">inner</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="o">*</span><span class="n">dx</span> <span class="o">-</span> <span class="n">inner</span><span class="p">(</span><span class="n">div</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span> <span class="o">-</span> <span class="n">inner</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">div</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="o">*</span><span class="n">dx</span>
</pre></div>
</div>
</div>
</div>
<p>Note that terms involving <code class="docutils literal notranslate"><span class="pre">TestFunction</span> <span class="pre">v</span></code> end up in the vector equation, whereas terms containing <code class="docutils literal notranslate"><span class="pre">TestFunction</span> <span class="pre">q</span></code> end up in the scalar equation. All terms defined in F are bilinear, in that they all contain one <code class="docutils literal notranslate"><span class="pre">TestFunction</span></code> and one <code class="docutils literal notranslate"><span class="pre">TrialFunction</span></code>. The sign of the velocity divergence has been set to negative, because this leads to a symmetric coefficient matrix, which is favorable for iterative solvers (even though we are not using a iterative solver here).</p>
<p>To solve the equations we need to create a <code class="docutils literal notranslate"><span class="pre">Function</span></code> in the mixed functionspace to hold the solution, for example like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">up_</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">VQ</span><span class="p">)</span>
<span class="n">bc0</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">VQ</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Expression</span><span class="p">((</span><span class="s2">&quot;x[0]*(1-x[0])&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">),</span> <span class="n">degree</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;std::abs(x[1])&gt;1-1e-12 &amp;&amp; on_boundary&quot;</span><span class="p">)</span>
<span class="n">bc1</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">VQ</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Constant</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="s2">&quot;std::abs(x[0]*(1-x[0])*x[1])&lt;1e-12 &amp;&amp; on_boundary&quot;</span><span class="p">)</span>
<span class="n">solve</span><span class="p">(</span><span class="n">lhs</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">==</span> <span class="n">rhs</span><span class="p">(</span><span class="n">F</span><span class="p">),</span> <span class="n">up_</span><span class="p">,</span> <span class="n">bcs</span><span class="o">=</span><span class="p">[</span><span class="n">bc0</span><span class="p">,</span> <span class="n">bc1</span><span class="p">])</span>
<span class="n">u_</span><span class="p">,</span> <span class="n">p_</span> <span class="o">=</span> <span class="n">up_</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">u_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/stokes_4_0.png" src="../../_images/stokes_4_0.png" />
</div>
</div>
<p>The boundary conditions will of course depend on the problem being solved. Here we have set homogeneous Dirichlet (no-slip) on three walls and a parabolic profile on top, which corresponds to a modified lid driven cavity.
Note that boundary conditions for velocity are set using <code class="docutils literal notranslate"><span class="pre">VQ.sub(0)</span></code>, where <code class="docutils literal notranslate"><span class="pre">sub(0)</span></code> corresponds to subspace 0 of the mixed <code class="docutils literal notranslate"><span class="pre">VQ</span></code> space. A Dirichlet boundary condition on pressure could have been set using <code class="docutils literal notranslate"><span class="pre">VQ.sub(1)</span></code>, but here that would be an over-specification.</p>
<p>The stream function <span class="math notranslate nohighlight">\(\psi(\boldsymbol{x}, t)\)</span> was defined in Eq. <a class="reference internal" href="similarity.html#equation-eq-streamfunction2d">(36)</a> in <a class="reference internal" href="similarity.html"><span class="doc std std-doc">Similarity solutions</span></a>. The Poisson equation <a class="reference internal" href="similarity.html#equation-eq-eqstreamfunction2d">(37)</a> for the streamfunction, can be transformed to a variational form by multiplying with a <code class="docutils literal notranslate"><span class="pre">TestFunction</span></code> <span class="math notranslate nohighlight">\(\psi_v\)</span> and then integrating over the domain using integration by parts</p>
<div class="math notranslate nohighlight" id="equation-eq-formstreamfunction">
<span class="eqno">(48)<a class="headerlink" href="#equation-eq-formstreamfunction" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
  \int_{\Omega} \psi_v \nabla^2 \psi \mathrm{d} x &amp;= -\int_{\Omega} \psi_v \omega_z \mathrm{d}x, \\
  -\int_{\Omega} \nabla (\psi_v) \cdot \nabla (\psi) \mathrm{d}x + \int_{\Gamma} \psi_v \nabla \psi \cdot \boldsymbol{n} \mathrm{d}s &amp;= -\int_{\Omega} \psi_v \omega_z \mathrm{d}x. 
\end{aligned}\end{split}\]</div>
<p>Here <span class="math notranslate nohighlight">\(\boldsymbol{n}\)</span> is the normal vector pointing outwards from the external boundary. The normal can be used directly in FEniCS forms through, e.g., <code class="docutils literal notranslate"><span class="pre">n=FacetNormal(mesh)</span></code>.</p>
<p>By taking the curl of the momentum equation <a class="reference internal" href="#equation-eq-stokes">(47)</a> and using that the curl of a gradient is always zero, an equation for the vorticity vector <span class="math notranslate nohighlight">\(\boldsymbol{\omega}\)</span> is obtained</p>
<div class="math notranslate nohighlight">
\[  \nabla^2 \boldsymbol{\omega} = 0.\]</div>
<p>Likewise, by taking the divergence (not gradient as it says in White <a class="bibtex reference internal" href="../mandatory/mandatory2.html#white06" id="id1">[Whi06]</a>) of the momentum equation <a class="reference internal" href="#equation-eq-stokes">(47)</a> we obtain an equation for the pressure</p>
<div class="math notranslate nohighlight">
\[  \nabla^2 p = 0,\]</div>
<p>which follows since <span class="math notranslate nohighlight">\(\nabla \cdot \nabla^2 \boldsymbol{u} = \nabla^2 (\nabla \cdot \boldsymbol{u})=0\)</span>. For Stokes flow both the pressure and the vorticity are governed by homogeneous Laplace equations. For 2D flows we also know the equation for the streamfunction <span class="math notranslate nohighlight">\(\nabla^2 \psi = -\omega_z\)</span>. Inserting this into the Laplace equation for <span class="math notranslate nohighlight">\(\omega_z\)</span> we obtain</p>
<div class="math notranslate nohighlight">
\[  \nabla^4 \psi = 0,\]</div>
<p>which is a biharmonic equation for the streamfunction. Obviously, if <span class="math notranslate nohighlight">\(\psi\)</span> is a solution to <span class="math notranslate nohighlight">\(\nabla^4 \psi = 0\)</span>, then <span class="math notranslate nohighlight">\(-\psi\)</span> is a solution as well. In other words, the direction of flow along a streamline is arbitrary and only fixed due to boundary conditions. Reversing the direction of the flow (like we do in the mandatory assignment) will not change the streamlines, but the values will get the opposite sign.</p>
<p>Stokes paradox states that it is not possible to obtain steady solutions to <span class="math notranslate nohighlight">\(\nabla^4 \psi = 0\)</span> for 2D flows with both free stream and no-slip boundary conditions. Stokes paradox is, like d’Alembert’s
paradox, really only a paradox because the equations do not represent real physical flow, just approximations in the limit. It follows from Stokes paradox that inertia can never be neglected for 2D flows with both free stream and no-slip boundary conditions.</p>
<div class="section" id="creeping-flow-past-a-sphere">
<h2>Creeping flow past a sphere<a class="headerlink" href="#creeping-flow-past-a-sphere" title="Permalink to this headline">¶</a></h2>
<p>Stokes flow past a sphere of radius <span class="math notranslate nohighlight">\(a\)</span> is a 3D flow and thus solutions to <span class="math notranslate nohighlight">\(\nabla^4 \psi = 0\)</span> may be found even though there is no-slip on the sphere wall and free stream far away. In spherical polar coordinates the stream function, <span class="math notranslate nohighlight">\(\psi\)</span>, is defined through</p>
<div class="math notranslate nohighlight" id="equation-eq-streamfunctionsphere">
<span class="eqno">(49)<a class="headerlink" href="#equation-eq-streamfunctionsphere" title="Permalink to this equation">¶</a></span>\[  u_r = \frac{1}{r^2 \sin \theta} \frac{\partial \psi}{\partial \theta}, \quad u_{\theta} = -\frac{1}{r \sin \theta} \frac{\partial \psi}{\partial r}. \]</div>
<p>The streamfunction equation becomes for spherical coordinates</p>
<div class="math notranslate nohighlight">
\[ \left( \frac{\partial^2 }{\partial r^2} + \frac{1}{r} \frac{\partial^2 }{\partial \theta^2} - \frac{\cot \theta}{r^2} \frac{\partial}{\partial \theta} \right)^2 \psi = 0,\]</div>
<p>with boundary conditions</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \frac{\partial \psi}{\partial r} &amp;=  \frac{\partial \psi}{\partial \theta} = 0, \quad \text{for}\quad r=a, \\
  \psi &amp;= \frac{1}{2} U r^2 \sin^2 \theta + \text{const}, \quad \text{for} \quad r \longleftrightarrow \infty.
\end{aligned}\end{split}\]</div>
<p>Using separation of variables White reports that the solution to this problem reads</p>
<div class="math notranslate nohighlight">
\[  \psi = \frac{1}{4}U a^2 \sin ^2 \theta \left(\frac{a}{r} - \frac{3r}{a} + \frac{2r^2}{a^2}\right),\]</div>
<p>and thus we obtain the velocity components from <a class="reference internal" href="#equation-eq-streamfunctionsphere">(49)</a></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  u_r &amp;= U \cos \theta  \left(1 + \frac{a^3}{2r^3} - \frac{3a}{2r}\right), \\
  u_{\theta} &amp;= U \sin \theta \left(-1 + \frac{a^3}{4r^3} + \frac{3a}{4r}\right)
\end{aligned}\end{split}\]</div>
<p>A few important notes</p>
<ul class="simple">
<li><p>The velocity is independent of <span class="math notranslate nohighlight">\(\rho\)</span> and <span class="math notranslate nohighlight">\(\mu\)</span>, which is actually true for all creeping flows.</p></li>
<li><p>There is perfect symmetry of the streamlines past the sphere. No wake and no separation.</p></li>
<li><p>The velocity is everywhere smaller than the free stream. This is contrary to inviscid flows where the velocity is maximum at the top and bottom of the sphere. For Stokes flow the velocity will here be zero due to no-slip.</p></li>
<li><p>The effect of the sphere can be observed at enormous distances away from the sphere. At <span class="math notranslate nohighlight">\(r=10a\)</span> the velocity is still <span class="math notranslate nohighlight">\(10 \%\)</span> lower  than the free stream.</p></li>
</ul>
<p>The pressure can be computed from the momentum equations in radial and <span class="math notranslate nohighlight">\(\theta\)</span>-direction</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \frac{\partial p}{\partial r} &amp;= \mu \left( \nabla^2 u_r - \frac{2 u_r}{r^2} - \frac{2}{r^2}\frac{\partial u_{\theta}}{\partial \theta} - \frac{2 u_{\theta} \cot \theta}{r^2} \right), \\
  \frac{\partial p}{\partial \theta} &amp;= \mu r \left( \nabla^2 u_{\theta} + \frac{2}{r^2}\frac{\partial u_r}{\partial \theta} - \frac{u_{\theta}}{r^2 \sin^2 \theta} \right)
\end{aligned}\end{split}\]</div>
<p>Insert for <span class="math notranslate nohighlight">\(u_r\)</span> and <span class="math notranslate nohighlight">\(u_{\theta}\)</span> and integrate both equations, using boundary conditions, to obtain</p>
<div class="math notranslate nohighlight" id="equation-eq-pressuresphere">
<span class="eqno">(50)<a class="headerlink" href="#equation-eq-pressuresphere" title="Permalink to this equation">¶</a></span>\[  p(r, \theta) = p_{\infty} - \frac{3 \mu a U}{2 r^2} \cos \theta,\]</div>
<p>where <span class="math notranslate nohighlight">\(p_{\infty}\)</span> is the pressure in the free stream. From <a class="reference internal" href="#equation-eq-pressuresphere">(50)</a> it is evident that the pressure is highest at the front (left hand side) of the sphere where <span class="math notranslate nohighlight">\(\theta=\pi\)</span>, and lowest at the rear where <span class="math notranslate nohighlight">\(\theta=0\)</span>. The pressure difference sets up a force acting on the sphere in the streamwise direction. The total force acting on the sphere is a vector that can be computed as</p>
<div class="math notranslate nohighlight">
\[  \boldsymbol{F} = \int_{\Gamma} \tau \cdot \boldsymbol{n}\, \mathrm{d}A,\]</div>
<p>where as before the total stress is composed of pressure and friction  through the stress tensor <span class="math notranslate nohighlight">\(\tau=-p \boldsymbol{I}+\mu(\nabla \boldsymbol{u}+\nabla \boldsymbol{u}^T)\)</span>. The normal to the surface of the sphere is everywhere aligned with the <span class="math notranslate nohighlight">\(r\)</span>-direction such that we can write</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \boldsymbol{F_p} + \boldsymbol{F_{\tau}} &amp;= \int_{\Gamma} \left(-p \boldsymbol{I} +\mu  (\nabla  \boldsymbol{u} + \nabla  \boldsymbol{u}^T) \right) \cdot \boldsymbol{n}\, \mathrm{d}A, \\
  &amp;= \int_{0}^{\pi} (\tau_{rr} + \tau_{r\theta})2\pi a^2 \sin \theta \mathrm{d} \theta,
\end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau_{rr}\)</span> and <span class="math notranslate nohighlight">\(\tau_{r\theta}\)</span> are the pressure and friction stresses respectively. This follows since the pressure force is always acting normal to the plane and shear acts in the tangent plane. Remember that <span class="math notranslate nohighlight">\(\tau_{ij}\)</span> is a force acting in the <span class="math notranslate nohighlight">\(j\)</span>-direction on a plane having <span class="math notranslate nohighlight">\(i\)</span> as the normal direction.</p>
<p>The pressure has already been computed. The remaining shear stress can be computed in spherical coordinates as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \tau_{r\theta} &amp;= \mu \left( \frac{1}{r} \frac{\partial u_r}{\partial \theta} + \frac{\partial u_{\theta}}{\partial r} - \frac{u_{\theta}}{r} \right), \\
  &amp;= -\frac{\mu U \sin \theta}{r} \frac{3 a^3}{2 r^3}.
\end{aligned}\end{split}\]</div>
<p>The total force acting in the streamwise direction is computed by inserting for <span class="math notranslate nohighlight">\(\tau_{rr}\)</span> and <span class="math notranslate nohighlight">\(\tau_{r\theta}\)</span> leading to two simple integral as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  F_{x} &amp;= |\boldsymbol{F_p}| \cos \theta + |\boldsymbol{F_{\tau}}| \sin \theta \\
        &amp;= 3 \mu U \pi a \left(\frac{2}{3} + \frac{4}{3} \right), \\
        &amp;= 6 \mu \pi U a.
\end{aligned}\end{split}\]</div>
<p>In other words, the drag force consists of 2/3 friction and 1/3 pressure.</p>
<p id="bibtex-bibliography-content/chapter3/stokes-0"><dl class="citation">
<dt class="bibtex label" id="white06"><span class="brackets"><a class="fn-backref" href="#id1">Whi06</a></span></dt>
<dd><p>Frank M. White. <em>Viscous Fluid Flow</em>. McGraw-Hill, third edition, 2006.</p>
</dd>
</dl>
</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "mikaem/MEK4300",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content/chapter3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="similarity.html" title="previous page">Similarity solutions</a>
    <a class='right-next' id="next-link" href="../chapter4/intro.html" title="next page">Chapter 4</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Mikael Mortensen<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>