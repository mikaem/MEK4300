

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Poiseuille flows &#8212; MEK4300 Lecture notes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"]}, "extensions": ["cancel.js", "AMSmath.js"]}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Similarity solutions" href="similarity.html" />
    <link rel="prev" title="Couette flows" href="couette.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/uio_logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">MEK4300 Lecture notes</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  White - Viscous Fluid Flow
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="reference internal" href="intro.html">
   Chapter 3
  </a>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="reference internal" href="planeshearflow.html">
     Parallel shear flows
    </a>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="couette.html">
       Couette flows
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Poiseuille flows
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="similarity.html">
     Similarity solutions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="stokes.html">
     Stokes flow
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter4/intro.html">
   Chapter 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter6/turbulence.html">
   Chapter 6
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../solutions/intro.html">
   Suggested solutions
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  FEniCS
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../fenics/intro.html">
   FEniCS
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Mandatory assignments
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../mandatory/mandatory1.html">
   First mandatory assignments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mandatory/mandatory2.html">
   Second mandatory assignment
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/content/chapter3/poiseuille.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/mikaem/MEK4300"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/mikaem/MEK4300/master?urlpath=tree/content/chapter3/poiseuille.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#steady-poiseuille-flows">
   Steady Poiseuille flows
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-circular-pipe">
     The circular pipe
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#noncircular-ducts">
     Noncircular ducts
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analysing-the-error">
       Analysing the error
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#combined-couette-and-poiseuille-flow">
     Combined Couette and Poiseuille flow
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#unsteady-duct-flows">
   Unsteady duct flows
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#starting-flow-in-a-cylindrical-pipe">
     Starting flow in a cylindrical pipe
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pipe-flow-due-to-an-oscillating-pressure-gradient">
     Pipe flow due to an oscillating pressure gradient
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#suggested-assignments-poiseuille">
   Suggested assignments Poiseuille
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#poiseuille-problems-from-white">
     Poiseuille problems from White
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computer-exercise-poiseuille">
     Computer exercise Poiseuille
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#verify-analytical-solutions">
       Verify analytical solutions
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="poiseuille-flows">
<h1>Poiseuille flows<a class="headerlink" href="#poiseuille-flows" title="Permalink to this headline">¶</a></h1>
<div class="figure align-default" id="channel">
<a class="reference internal image-reference" href="../../_images/channelprofile3.png"><img alt="../../_images/channelprofile3.png" src="../../_images/channelprofile3.png" style="width: 300px; height: 200px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3 </span><span class="caption-text">Channel flow is a pressure driven Poiseuille flow</span><a class="headerlink" href="#channel" title="Permalink to this image">¶</a></p>
</div>
<p>Poiseuille flows are driven by pumps that forces the fluid to flow through pressure. Fluids flow naturally from regions of high pressure to regions of low pressure. Typical examples are cylindrical pipe flow and other duct flows. A fully developed plane channel flow is shown above. Fully developed Poiseuille flows exists only far from the entrances and exits of the ducts, where the flow is aligned parallel to the duct walls. If we assume the flow is in the x-direction, as shown in Fig. 3-6 of <a class="bibtex reference internal" href="../mandatory/mandatory2.html#white06" id="id1">[Whi06]</a>, then the velocity vector is <span class="math notranslate nohighlight">\(\boldsymbol{u}(y,z,t)=(u(y,z,t),0,0)\)</span> and Navier-Stokes equations can be simplified to</p>
<div class="math notranslate nohighlight" id="equation-eq-planechannelns">
<span class="eqno">(16)<a class="headerlink" href="#equation-eq-planechannelns" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
  \frac{\partial u}{\partial t} &amp;= \nu \nabla ^2 u - \frac{1}{\rho}\frac{\mathrm{d} p}{\mathrm{d} x},  \\
  \frac{\partial u}{\partial x} &amp;= 0,
\end{aligned}\end{split}\]</div>
<p>The equations are still linear because the flow is aligned in one direction and convection is thus zero. The only difference from Couette flow is that there is a non-zero source term in the pressure gradient. The transient term on the left hand side is zero for stationary flows.</p>
<p>The total volume flow, <span class="math notranslate nohighlight">\(Q\)</span>, through any duct is found by integrating the velocity over the entire cross section, <span class="math notranslate nohighlight">\(C\)</span>, of the duct</p>
<div class="math notranslate nohighlight" id="equation-eq-q">
<span class="eqno">(17)<a class="headerlink" href="#equation-eq-q" title="Permalink to this equation">¶</a></span>\[  Q = \displaystyle{\int_{\mathrm{C}}} u \mathrm{d}A.\]</div>
<p>Using <a class="reference internal" href="#equation-eq-q">(17)</a> it is also possible to define an average velocity, <span class="math notranslate nohighlight">\(\overline{u}\)</span>, through the duct</p>
<div class="math notranslate nohighlight">
\[  \overline{u} = \frac{Q}{A}.\]</div>
<p>The average velocity is subsequently used to define the Reynolds number and certain friction factors - engineering tools used to classify duct flow.</p>
<div class="section" id="steady-poiseuille-flows">
<h2>Steady Poiseuille flows<a class="headerlink" href="#steady-poiseuille-flows" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-circular-pipe">
<h3>The circular pipe<a class="headerlink" href="#the-circular-pipe" title="Permalink to this headline">¶</a></h3>
<p>For a steady cylindrical pipe flow with radius <span class="math notranslate nohighlight">\(r_0\)</span> the solution to <a class="reference internal" href="#equation-eq-planechannelns">(16)</a> is found simply by integrating twice and applying boundary conditions:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \frac{\nu}{r}\frac{\mathrm{d}}{\mathrm{d} r}\left(r \frac{\mathrm{d} u}{\mathrm{d} r} \right) &amp;= \frac{1}{\rho}\frac{\mathrm{d} p}{\mathrm{d} x}, \\
  \frac{\mathrm{d}}{\mathrm{d} r}\left( r \frac{\mathrm{d} u }{\mathrm{d} r} \right) &amp;= \frac{r}{\mu}\frac{\mathrm{d} p}{\mathrm{d} x}, \\
   r \frac{\mathrm{d} u}{\mathrm{d} r} &amp;= \frac{r^2}{2\mu}\frac{\mathrm{d} p}{\mathrm{d} x} + C_1, \\
   \frac{\mathrm{d} u}{\mathrm{d} r} &amp;= \frac{r}{2\mu}\frac{\mathrm{d} p}{\mathrm{d} x} + \frac{C_1}{r}, \\
u(r) &amp;= \frac{r^2}{4\mu}\frac{\mathrm{d} p}{\mathrm{d} x} + C_1\ln(r)+ C_2,
\end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(C_1\)</span> and <span class="math notranslate nohighlight">\(C_2\)</span> are integration constants. The constant <span class="math notranslate nohighlight">\(C_1\)</span> must be zero for the flow at the center of the pipe to remain finite. The condition at the wall <span class="math notranslate nohighlight">\(u(r_0)=0\)</span> gives</p>
<div class="math notranslate nohighlight">
\[  C_2 = -\frac{r_0^2}{4\mu}\frac{\partial p}{\partial x},\]</div>
<p>which leads to the final expression for the pipe flow</p>
<div class="math notranslate nohighlight" id="equation-eq-steadypoiseuille">
<span class="eqno">(18)<a class="headerlink" href="#equation-eq-steadypoiseuille" title="Permalink to this equation">¶</a></span>\[  u(r) = -\frac{1}{4\mu}\frac{\partial p}{\partial x} \left(r_0^2 - r^2 \right)\]</div>
</div>
<div class="section" id="noncircular-ducts">
<h3>Noncircular ducts<a class="headerlink" href="#noncircular-ducts" title="Permalink to this headline">¶</a></h3>
<p>For steady and fully developed duct flows the governing equation is simply the Poisson equation</p>
<div class="math notranslate nohighlight" id="equation-eq-poisson">
<span class="eqno">(19)<a class="headerlink" href="#equation-eq-poisson" title="Permalink to this equation">¶</a></span>\[  \nabla ^2 u = \frac{1}{\mu} \frac{\mathrm{d}p}{\mathrm{d}x}.\]</div>
<p>The equation is linear and very easy to solve numerically for any shape of the duct. There is also a great number of analytical solutions available for noncircular duct flows, solutions that can be used to verify the quality of the numerical software. The duct solutions are often used for specifying inlet profiles to much more complicating geometries, where the flow enters the geometry through a duct.</p>
<p>In the code blelow we show a FEniCS code used to solve <a class="reference internal" href="#equation-eq-poisson">(19)</a> for a rectangular duct spanned as <span class="math notranslate nohighlight">\(-a \leqslant y \leqslant a\)</span> and <span class="math notranslate nohighlight">\(-b \leqslant z \leqslant b\)</span> . Of interest here is the computation of the very complicated analytical expression for the velocity given as</p>
<div class="math notranslate nohighlight" id="equation-eq-rectangle">
<span class="eqno">(20)<a class="headerlink" href="#equation-eq-rectangle" title="Permalink to this equation">¶</a></span>\[  u(z,y) = \frac{16a^2}{\mu \pi^3}\left(-\frac{\mathrm{d}p}{\mathrm{d}x} \right) \sum_{i=1,3,5,...}^{\infty} (-1)^{\frac{i-1}{2}} \left[1-\frac{\cosh (i \pi z)/2a}{\cosh (i \pi b) / 2a} \right] \times \frac{\cos(i \pi y) / 2a}{i^3}.\]</div>
<p>The FEniCS implementation of this exact solution overloads the <code class="docutils literal notranslate"><span class="pre">UserExpression</span></code> class and  you should recognize <a class="reference internal" href="#equation-eq-rectangle">(20)</a> in the overloaded <code class="docutils literal notranslate"><span class="pre">eval</span></code> method. Here <span class="math notranslate nohighlight">\(x\)</span> is an array of the coordinates and <span class="math notranslate nohighlight">\(x[0]\)</span> and <span class="math notranslate nohighlight">\(x[1]\)</span> represent <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span> respectively. Unfortunately, the Python <code class="docutils literal notranslate"><span class="pre">UserExpression</span></code> <code class="docutils literal notranslate"><span class="pre">u_exact</span></code> is quite slow to interpolate due to the non-vectorized for-loop. For this reason, a C++ version of the same <code class="docutils literal notranslate"><span class="pre">Expression</span></code> is implemented instead, which speeds up the program with approximately a factor of 45.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dolfin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">cosh</span><span class="p">,</span> <span class="n">cos</span>
<span class="n">set_log_active</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="n">dpdx</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">factor</span> <span class="o">=</span> <span class="mf">16.</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="o">/</span><span class="n">mu</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">pi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">dpdx</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">u_exact</span><span class="p">(</span><span class="n">UserExpression</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">u</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">u</span> <span class="o">+=</span> <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">cosh</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">2.</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">/</span>
                   <span class="n">cosh</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">a</span><span class="p">))</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">2.</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">i</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span> <span class="o">*</span> <span class="n">factor</span>

<span class="c1"># Much faster C++ version</span>
<span class="n">ue_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">#include &lt;pybind11/pybind11.h&gt;</span>
<span class="s1">#include &lt;pybind11/eigen.h&gt;</span>
<span class="s1">namespace py = pybind11;</span>

<span class="s1">#include &lt;dolfin/function/Expression.h&gt;</span>

<span class="s1">class U : public dolfin::Expression</span>
<span class="s1">{</span>
<span class="s1">  public:</span>

<span class="s1">    double a, b, mu, dpdx;</span>

<span class="s1">  void eval(Eigen::Ref&lt;Eigen::VectorXd&gt; values,</span>
<span class="s1">            Eigen::Ref&lt;const Eigen::VectorXd&gt; x,</span>
<span class="s1">            const ufc::cell&amp; cell) const override</span>
<span class="s1">    {</span>
<span class="s1">      double u = 0.;</span>
<span class="s1">      double factor = 16.*a*a/mu/pow(DOLFIN_PI, 3)*(-dpdx);</span>
<span class="s1">      for (std::size_t i=1; i&lt;500; i=i+2)</span>
<span class="s1">        u += pow(-1, (i-1)/2 % 2)*(1.-cosh(i*DOLFIN_PI*x[1]/2./a)/</span>
<span class="s1">           cosh(i*DOLFIN_PI*b/2./a))*cos(i*DOLFIN_PI*x[0]/2./a)/pow(i, 3);</span>
<span class="s1">      values[0] = u*factor;</span>
<span class="s1">    }</span>
<span class="s1">};</span>

<span class="s1">PYBIND11_MODULE(SIGNATURE, m)</span>
<span class="s1">{</span>
<span class="s1">  py::class_&lt;U, std::shared_ptr&lt;U&gt;, dolfin::Expression&gt;</span>
<span class="s1">    (m, &quot;U&quot;)</span>
<span class="s1">    .def(py::init&lt;&gt;())</span>
<span class="s1">    .def_readwrite(&quot;a&quot;, &amp;U::a)</span>
<span class="s1">    .def_readwrite(&quot;b&quot;, &amp;U::b)</span>
<span class="s1">    .def_readwrite(&quot;mu&quot;, &amp;U::mu)</span>
<span class="s1">    .def_readwrite(&quot;dpdx&quot;, &amp;U::dpdx);</span>
<span class="s1">}</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">u_c</span> <span class="o">=</span> <span class="n">CompiledExpression</span><span class="p">(</span><span class="n">compile_cpp_code</span><span class="p">(</span><span class="n">ue_code</span><span class="p">)</span><span class="o">.</span><span class="n">U</span><span class="p">(),</span> <span class="n">a</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">b</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">b</span><span class="p">),</span>
                         <span class="n">mu</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">mu</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">dpdx</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">dpdx</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">mesh</span> <span class="o">=</span> <span class="n">RectangleMesh</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="n">degree</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">TrialFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">TestFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
    <span class="n">F</span> <span class="o">=</span> <span class="n">inner</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">grad</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">*</span><span class="n">dx</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">mu</span><span class="o">*</span><span class="n">dpdx</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">dx</span>
    <span class="n">bc</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">Constant</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">DomainBoundary</span><span class="p">())</span>
    <span class="n">u_</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
    <span class="n">solve</span><span class="p">(</span><span class="n">lhs</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">==</span> <span class="n">rhs</span><span class="p">(</span><span class="n">F</span><span class="p">),</span> <span class="n">u_</span><span class="p">,</span> <span class="n">bcs</span><span class="o">=</span><span class="n">bc</span><span class="p">)</span>

    <span class="c1">#u_e = interpolate(u_exact(), V)  # slow, but otherwise the same as below</span>
    <span class="n">u_e</span> <span class="o">=</span> <span class="n">interpolate</span><span class="p">(</span><span class="n">u_c</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
    <span class="n">bc</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">u_e</span><span class="o">.</span><span class="n">vector</span><span class="p">())</span>
    <span class="n">u_error</span> <span class="o">=</span> <span class="n">errornorm</span><span class="p">(</span><span class="n">u_e</span><span class="p">,</span> <span class="n">u_</span><span class="p">,</span> <span class="n">degree_rise</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">u_error</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">hmin</span><span class="p">()</span>

<span class="n">E</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">h</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">degree</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">]:</span>
    <span class="n">ei</span><span class="p">,</span> <span class="n">hi</span> <span class="o">=</span> <span class="n">main</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="n">degree</span><span class="p">)</span>
    <span class="n">E</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ei</span><span class="p">)</span>
    <span class="n">h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hi</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">log</span> <span class="k">as</span> <span class="n">ln</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">E</span><span class="p">)):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">ln</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">E</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">ln</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;h=</span><span class="si">%2.2E</span><span class="s2"> E=</span><span class="si">%2.2E</span><span class="s2"> r=</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">E</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">r</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>h=4.47E-01 E=6.41E-03 r=1.76
h=2.24E-01 E=1.69E-03 r=1.93
h=1.12E-01 E=4.28E-04 r=1.98
h=7.45E-02 E=1.91E-04 r=1.99
</pre></div>
</div>
</div>
</div>
<div class="section" id="analysing-the-error">
<span id="id2"></span><h4>Analysing the error<a class="headerlink" href="#analysing-the-error" title="Permalink to this headline">¶</a></h4>
<p>In the code for the rectangular duct we compute the errornorm that compares the computed finite element solution with the exact solution. This error will depend on the mesh size and the order of the polynomial approximation. The error should disappear in the limit of a highly resolved mesh or for very high order polynomials. Given the polynomial order, the rate at which the error disappears can be computed by performing experiments with meshes of different resolution. We assume that the error for a mesh of element size <span class="math notranslate nohighlight">\(h_i\)</span> can be written as <span class="math notranslate nohighlight">\(E_i=Ch_i^r\)</span>, where <span class="math notranslate nohighlight">\(C\)</span> is a constant. We now want to find the order <span class="math notranslate nohighlight">\(r\)</span> of which the error disappears with mesh refinement. The order <span class="math notranslate nohighlight">\(r\)</span> can be found by computing <span class="math notranslate nohighlight">\(E_i\)</span> for two different <span class="math notranslate nohighlight">\(h_i\)</span>’s, i.e., <span class="math notranslate nohighlight">\(E_i=h_i^r\)</span> and <span class="math notranslate nohighlight">\(E_{i-1}=h_{i-1}^r\)</span>, and then isolate <span class="math notranslate nohighlight">\(r\)</span>:</p>
<div class="math notranslate nohighlight">
\[ r = \frac{\ln (E_i/E_{i-1})}{\ln (h_i/h_{i-1})}.\]</div>
<p>It is this error that is printed out at the end above. Changing the degree in the <code class="docutils literal notranslate"><span class="pre">FunctionSpace</span></code> to 2 the order should be three. Lets try it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">h</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">degree</span> <span class="o">=</span> <span class="mi">2</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">]:</span>
    <span class="n">ei</span><span class="p">,</span> <span class="n">hi</span> <span class="o">=</span> <span class="n">main</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="n">degree</span><span class="p">)</span>
    <span class="n">E</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ei</span><span class="p">)</span>
    <span class="n">h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hi</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">log</span> <span class="k">as</span> <span class="n">ln</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">E</span><span class="p">)):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">ln</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">E</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">ln</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;h=</span><span class="si">%2.2E</span><span class="s2"> E=</span><span class="si">%2.2E</span><span class="s2"> r=</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">E</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">r</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>h=4.47E-01 E=2.14E-04 r=3.13
h=2.24E-01 E=2.63E-05 r=3.03
h=1.12E-01 E=3.25E-06 r=3.02
h=7.45E-02 E=9.41E-07 r=3.05
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="combined-couette-and-poiseuille-flow">
<h3>Combined Couette and Poiseuille flow<a class="headerlink" href="#combined-couette-and-poiseuille-flow" title="Permalink to this headline">¶</a></h3>
<p>It is possible to combine an applied pressure gradient with moving walls. Such flows are termed combined Couette-Poiseuille flows and they are governed by the Poiseuille <a class="reference internal" href="#equation-eq-planechannelns">(16)</a>. The solution to a combined Couette-Poiseuille flow can be found as the sum of a Couette solution <span class="math notranslate nohighlight">\(u_c\)</span> using zero pressure gradient and a homogeneous Poiseuille solution <span class="math notranslate nohighlight">\(u_p\)</span> using zero velocity on walls. For a plane channel with <span class="math notranslate nohighlight">\(u(h) = U\)</span> and <span class="math notranslate nohighlight">\(u(-h)=0\)</span> the solution is thus found by solving the two problems, for Couette</p>
<div class="math notranslate nohighlight" id="equation-eq-couettecomb">
<span class="eqno">(21)<a class="headerlink" href="#equation-eq-couettecomb" title="Permalink to this equation">¶</a></span>\[  \nabla^2 u_c = 0, \quad u_c(h)=U,\,u_c(-h)=0,\]</div>
<p>and Poiseuille</p>
<div class="math notranslate nohighlight" id="equation-eq-poiseuillecomb">
<span class="eqno">(22)<a class="headerlink" href="#equation-eq-poiseuillecomb" title="Permalink to this equation">¶</a></span>\[\nabla^2 u_p = \frac{1}{\mu}\frac{\mathrm{d}p}{\mathrm{d}x}, \quad u_p(\pm h)=0. \]</div>
<p>The combined solution <span class="math notranslate nohighlight">\(u = u_c + u_p\)</span> is the solution to the original problem. This can be seen by summing <a class="reference internal" href="#equation-eq-couettecomb">(21)</a> and <a class="reference internal" href="#equation-eq-poiseuillecomb">(22)</a> and also evidently <span class="math notranslate nohighlight">\(u(h) = u_c(h)+u_p(h) = U\)</span> and similarily for <span class="math notranslate nohighlight">\(y=-h\)</span>. The superposition is possible simply because the governing equation is linear. The principle is used also for transient flows in both Chapters (3-4) and (3-5).</p>
</div>
</div>
<div class="section" id="unsteady-duct-flows">
<h2>Unsteady duct flows<a class="headerlink" href="#unsteady-duct-flows" title="Permalink to this headline">¶</a></h2>
<p>Unsteady plane shear flows are experienced by fluids where the driving forces are suddenly or continuously changed. A fluid initially at rest will for example respond to a sudden increase in the pressure gradient (we suddenly start the pump) and the volume flow through the duct will then increase monotonically until steady state is reached. The applied pressure gradient may also vary in time. Another scenario is that a wall is suddenly or continuously set in motion, dragging with it the fluid initially at rest. Common for these flows is that the transient term in the Navier Stokes equations cannot be neglected.</p>
<div class="section" id="starting-flow-in-a-cylindrical-pipe">
<h3>Starting flow in a cylindrical pipe<a class="headerlink" href="#starting-flow-in-a-cylindrical-pipe" title="Permalink to this headline">¶</a></h3>
<p>When a fluid initially at rest suddenly is exposed to a constant pressure gradient, the fluid will start to move as a response to the applied forces and the flow will increase for some time until the steady state Poiseuille flow profile <a class="reference internal" href="#equation-eq-steadypoiseuille">(18)</a> is reached. For convenience we modify this equation slightly here and write it for the steady velocity <span class="math notranslate nohighlight">\(u_s\)</span> as</p>
<div class="math notranslate nohighlight">
\[  u_s = u_{max} \left(1-\tilde{r}^2 \right),\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[  u_{max} = -\frac{r_0^2}{4\mu}\frac{\partial p}{\partial x}\]</div>
<p>and <span class="math notranslate nohighlight">\(\tilde{r}=r/r_0\)</span>. We use the superposition principle and split the equation into two contributions</p>
<div class="math notranslate nohighlight">
\[  u(r, t) = v(r, t) + u_s(r),\]</div>
<p>where <span class="math notranslate nohighlight">\(u(r,t)\)</span> is the complete solution and <span class="math notranslate nohighlight">\(v(r,t)\)</span> is the solution to the homogeneous <a class="reference internal" href="#equation-eq-planechannelns">(16)</a> in cylinder coordinates:</p>
<div class="math notranslate nohighlight" id="equation-eq-unsteadycyl">
<span class="eqno">(23)<a class="headerlink" href="#equation-eq-unsteadycyl" title="Permalink to this equation">¶</a></span>\[  \frac{\partial v}{\partial t} = \nu \left( \frac{\partial ^2 v}{\partial r^2} + \frac{1}{r} \frac{\partial v}{\partial r} \right), \]</div>
<p>subject to boundary condition <span class="math notranslate nohighlight">\(v(r_0,t)=0\)</span> and initial condition <span class="math notranslate nohighlight">\(v(r,0) = -u_s(r)\)</span>. The equation can be non-dimensionalized by multiplying with <span class="math notranslate nohighlight">\(r_0^2/\nu\)</span> and using <span class="math notranslate nohighlight">\(\tilde{t}=t\nu/r_0^2\)</span> and <span class="math notranslate nohighlight">\(\tilde{r}=r/r_0\)</span></p>
<div class="math notranslate nohighlight" id="equation-eq-unsteadycylnorm">
<span class="eqno">(24)<a class="headerlink" href="#equation-eq-unsteadycylnorm" title="Permalink to this equation">¶</a></span>\[  \frac{\partial v}{\partial \tilde{t}} = \frac{\partial ^2 v}{\partial \tilde{r}^2} + \frac{1}{\tilde{r}} \frac{\partial v}{\partial \tilde{r}}.\]</div>
<p>Equation <a class="reference internal" href="#equation-eq-unsteadycylnorm">(24)</a> can be solved using a separation of variables <span class="math notranslate nohighlight">\(v(\tilde{r},\tilde{t}) = V(\tilde{r})T(\tilde{t})\)</span>. Inserted into <a class="reference internal" href="#equation-eq-unsteadycylnorm">(24)</a> we obtain</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
 V \frac{\mathrm{d} T}{\mathrm{d} \tilde{t}} &amp;= T \left( \frac{\mathrm{d}^2 V}{\mathrm{d}\tilde{r}^2} + \frac{1}{\tilde{r}} \frac{\mathrm{d}V}{\mathrm{d}\tilde{r}} \right), \\
  V  \dot{T} &amp;= T \left( V^{''} + \frac{1}{\tilde{r}} V^{'} \right), \\
  \frac{\dot{T}}{T} &amp;= \frac{V^{''} + \frac{1}{\tilde{r}} V^{'}}{V},
\end{aligned}\end{split}\]</div>
<p>where the dot and apostrophe represent ordinary derivatives with respect to <span class="math notranslate nohighlight">\(\tilde{t}\)</span> and <span class="math notranslate nohighlight">\(\tilde{r}\)</span> respectively. Since the left hand side depends only on <span class="math notranslate nohighlight">\(\tilde{t}\)</span> and the right hand side only on <span class="math notranslate nohighlight">\(\tilde{r}\)</span>, both sides must be equal to a constant. It turns out that the constant must be negative to satisfy the appropriate boundary conditions. We call the new constant <span class="math notranslate nohighlight">\(-\lambda^2\)</span> and obtain the two separate ordinary differential equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \dot{T} + \lambda^2 T &amp;= 0, \\
  \tilde{r}^2 V^{''} + \tilde{r} V^{'} + \lambda^2 \tilde{r}^2 V &amp;= 0.
\end{aligned}\end{split}\]</div>
<p>The first equation has solution</p>
<div class="math notranslate nohighlight">
\[T(t) = e^{-\lambda^2 \tilde{t}}.\]</div>
<p>The second equation can be rewritten using <span class="math notranslate nohighlight">\(x=\tilde{r}\lambda\)</span> and chain rule differentiation leading to</p>
<div class="math notranslate nohighlight" id="equation-eq-besselequation">
<span class="eqno">(25)<a class="headerlink" href="#equation-eq-besselequation" title="Permalink to this equation">¶</a></span>\[ x^2 V^{''} + x V^{'} + x^2 V = 0,\]</div>
<p>with the apostrophe here being a derivative with respect to <span class="math notranslate nohighlight">\(x\)</span>. Equation <a class="reference internal" href="#equation-eq-besselequation">(25)</a> is Bessel’s differential equation of zero order. The solution to Bessel’s equation is the Bessel function of the first kind of order zero</p>
<div class="math notranslate nohighlight">
\[ J_0(x).\]</div>
<p>A solution to <span class="math notranslate nohighlight">\(V\)</span> becomes</p>
<div class="math notranslate nohighlight">
\[V(\tilde{r}) = A J_0(\lambda \tilde{r}),\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> is a constant. We now need to make sure that the boundary  and initial conditions are satisfied. The boundary condition requires
<span class="math notranslate nohighlight">\(V(1)=J_0(\lambda)=0\)</span>. The figure below shows how the Bessel function behaves. Apparently it looks somewhat like a damped cosine function with multiple roots that we call <span class="math notranslate nohighlight">\(\lambda_k\)</span>. The first four positive roots are located at  $ x = 2.4048, 5.5201, 8.6537, 11.7915$ corresponding to <span class="math notranslate nohighlight">\(\lambda_1, \lambda_2, \lambda_3, \lambda_4\)</span>.</p>
<div class="figure align-default" id="beselfunction">
<a class="reference internal image-reference" href="../../_images/Besselplot.png"><img alt="../../_images/Besselplot.png" src="../../_images/Besselplot.png" style="width: 400px; height: 300px;" /></a>
<p class="caption"><span class="caption-number">Fig. 4 </span><span class="caption-text">Bessel function</span><a class="headerlink" href="#beselfunction" title="Permalink to this image">¶</a></p>
</div>
<p>One general solution is thus</p>
<div class="math notranslate nohighlight">
\[  V(\tilde{r}) = A_k J_0(\lambda_k \tilde{r})\]</div>
<p>with a total solution</p>
<div class="math notranslate nohighlight">
\[  v(\tilde{r}, \tilde{t}) = A_k J_0(\lambda_k \tilde{r})  e^{-\lambda_k^2 \tilde{t}}.\]</div>
<p>Since the equations are linear we can use superposition and obtain a total solution simply by summing over multiple possible solutions</p>
<div class="math notranslate nohighlight">
\[v(\tilde{r}, \tilde{t}) = \sum_{k=1}^{\infty} A_k J_0(\lambda_k \tilde{r})  e^{-\lambda_k^2 \tilde{t}}.\]</div>
<p>We now have a solution consisting of many constants that satisfy the boundary condition. It remains to close these constants using the initial condition <span class="math notranslate nohighlight">\(v(\tilde{r}, 0) = -u_{max}(1-\tilde{r}^2)\)</span>.</p>
<p>We have</p>
<div class="math notranslate nohighlight" id="equation-eq-besselinit">
<span class="eqno">(26)<a class="headerlink" href="#equation-eq-besselinit" title="Permalink to this equation">¶</a></span>\[  \sum_{k=1}^{\infty} A_k J_0(\lambda_k \tilde{r}) = -u_{max}(1-\tilde{r}^2)\]</div>
<p>and we want to find <span class="math notranslate nohighlight">\(A_k\)</span>. To this end we use orthogonality</p>
<div class="math notranslate nohighlight" id="equation-eq-besselorthogonal">
<span class="eqno">(27)<a class="headerlink" href="#equation-eq-besselorthogonal" title="Permalink to this equation">¶</a></span>\[ \int_0^1 x J_n(\lambda_k x) J_n(\lambda_m x) dx = 0 \quad \mathrm{for\,} k \neq m\]</div>
<p>and orthonormality</p>
<div class="math notranslate nohighlight" id="equation-eq-besselorthonormal">
<span class="eqno">(28)<a class="headerlink" href="#equation-eq-besselorthonormal" title="Permalink to this equation">¶</a></span>\[ \int_0^1 x J_n(\lambda_k x) J_n(\lambda_k x) dx = \frac{J_{n+1}^2(\lambda_k)}{2}.\]</div>
<p>If <a class="reference internal" href="#equation-eq-besselinit">(26)</a> is multiplied by <span class="math notranslate nohighlight">\(\tilde{r} J_0(\lambda_m \tilde{r})\)</span> and integrated from zero to unity we get</p>
<div class="math notranslate nohighlight">
\[  \int_0^1 \tilde{r} J_0(\lambda_m \tilde{r}) \sum_{k=1}^{\infty} A_k J_0(\lambda_k \tilde{r}) \mathrm{d}\tilde{r} = -\int_0^1 u_{max}(1-\tilde{r}^2) \tilde{r} J_0(\lambda_m \tilde{r}) \mathrm{d}\tilde{r}.\]</div>
<p>We now use <a class="reference internal" href="#equation-eq-besselorthogonal">(27)</a> to eliminate all terms on the left hand side where <span class="math notranslate nohighlight">\(k \neq m\)</span> and insert for <a class="reference internal" href="#equation-eq-besselorthonormal">(28)</a>. The result is a closed expression for <span class="math notranslate nohighlight">\(A_k\)</span></p>
<div class="math notranslate nohighlight" id="equation-eq-besselak">
<span class="eqno">(29)<a class="headerlink" href="#equation-eq-besselak" title="Permalink to this equation">¶</a></span>\[  A_k = -\frac{2}{J_1^2(\lambda_k)} \int_0^1 \tilde{r} J_0(\lambda_k \tilde{r})u_{max}(1-\tilde{r}^2) \mathrm{d}\tilde{r}.\]</div>
<p>The integral on the right hand side can be evaluated exactly (details left out for now) leading to</p>
<div class="math notranslate nohighlight" id="equation-eq-besselakfinal">
<span class="eqno">(30)<a class="headerlink" href="#equation-eq-besselakfinal" title="Permalink to this equation">¶</a></span>\[  A_k = -\frac{4 u_{max} J_2(\lambda_k)}{\lambda_k^2 J_1^2(\lambda_k)} = -\frac{8 u_{max}}{\lambda_k^3 J_1(\lambda_k)}\]</div>
<p>The final solution to starting flow in a cylinder, <a class="reference internal" href="#equation-eq-unsteadycyl">(23)</a>, becomes</p>
<div class="math notranslate nohighlight">
\[ u(\tilde{r}, \tilde{t}) = u_{max}(1 - \tilde{r}^2) - \sum_{k=1}^{\infty} \frac{8 u_{max} J_0(\lambda_k \tilde{r})}{\lambda_k^3 J_1(\lambda_k)} e^{-\lambda_k^2 \tilde{t}}\]</div>
<p>in agreement with Eq. (3-96) in White  <a class="bibtex reference internal" href="../mandatory/mandatory2.html#white06" id="id3">[Whi06]</a>.</p>
</div>
<div class="section" id="pipe-flow-due-to-an-oscillating-pressure-gradient">
<h3>Pipe flow due to an oscillating pressure gradient<a class="headerlink" href="#pipe-flow-due-to-an-oscillating-pressure-gradient" title="Permalink to this headline">¶</a></h3>
<p>Consider now the same problem as in the previous section, but with a pressure gradient that is oscillating in time</p>
<div class="math notranslate nohighlight">
\[  \frac{\partial p}{\partial x} = -\rho K e^{i\omega t},\]</div>
<p>where <span class="math notranslate nohighlight">\(i = \sqrt{-1}\)</span> and</p>
<div class="math notranslate nohighlight">
\[  e^{i\omega t} = \cos \omega t + i \sin \omega t.\]</div>
<p>The governing equation for the cylinder is thus</p>
<div class="math notranslate nohighlight" id="equation-eq-unsteadycyl2">
<span class="eqno">(31)<a class="headerlink" href="#equation-eq-unsteadycyl2" title="Permalink to this equation">¶</a></span>\[  \frac{\partial u}{\partial t} = K e^{i\omega t} + \nu \left( \frac{\partial ^2 u}{\partial r^2} + \frac{1}{r} \frac{\partial u}{\partial r} \right).\]</div>
<p>We now want solve <a class="reference internal" href="#equation-eq-unsteadycyl2">(31)</a> with no-slip boundary conditions on the cylinder walls. We will neglect the initial condition and look only for a long-term steady oscillatory solution on the form</p>
<div class="math notranslate nohighlight" id="equation-eq-oscpressuresol">
<span class="eqno">(32)<a class="headerlink" href="#equation-eq-oscpressuresol" title="Permalink to this equation">¶</a></span>\[  u(r, t) = e^{i\omega t} V(r).\]</div>
<p>That is, we look for a solution where all the transient behaviour is governed by an oscillating pressure gradient proportional to <span class="math notranslate nohighlight">\(e^{i\omega t}\)</span>.</p>
<p>Inserting for <a class="reference internal" href="#equation-eq-oscpressuresol">(32)</a> in <a class="reference internal" href="#equation-eq-unsteadycyl2">(31)</a> and using the same nomenclature as in the previous section we obtain</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  V i\omega \cancel{e^{i\omega t}} &amp;= K  \cancel{e^{i\omega t}} + \nu \cancel{e^{i\omega t}} \left(V'' + \frac{1}{r} V'\right) \\
  V i\omega &amp;= K + \nu \left(V'' + \frac{1}{r} V'\right) \\
  r^2 V'' + r V' - \frac{i\omega}{\nu} r^2 V &amp;= - \frac{K r^2}{\nu}.
\end{aligned}\end{split}\]</div>
<p>Using <span class="math notranslate nohighlight">\(x=r\sqrt{i\omega/\nu}\)</span> and chain rule differentiation the equation can be rewritten as</p>
<div class="math notranslate nohighlight" id="equation-eq-intermediatev">
<span class="eqno">(33)<a class="headerlink" href="#equation-eq-intermediatev" title="Permalink to this equation">¶</a></span>\[    x^2 V'' + x V' - x^2 V = - \frac{K x^2}{i \omega},\]</div>
<p>where the apostrophe now represents differentiation with respect to <span class="math notranslate nohighlight">\(x\)</span>. This equation looks very much like a <a class="reference external" href="http://mathworld.wolfram.com/ModifiedBesselDifferentialEquation.html">modified Bessel equation</a> of zero order. The only difference is the right hand side, which should be zero. To get rid of the right hand side we use another change of variables</p>
<div class="math notranslate nohighlight">
\[  V =  \hat{V} + \frac{K}{i \omega}\]</div>
<p>and insert this in <a class="reference internal" href="#equation-eq-intermediatev">(33)</a> such that</p>
<div class="math notranslate nohighlight">
\[    x^2 \hat{V}'' + x \hat{V}' - x^2 \hat{V} = 0.\]</div>
<p>The solution to the modified Bessel equation of zero order is the modified Bessel function of the first kind (the second kind cannot be used since this function is infinite for <span class="math notranslate nohighlight">\(x=0\)</span>) of zero order, <span class="math notranslate nohighlight">\(I_0\)</span>, so</p>
<div class="math notranslate nohighlight">
\[  \hat{V}(x) = A I_0(x),\]</div>
<p>or in terms of the ordinary Bessel function:</p>
<div class="math notranslate nohighlight">
\[  \hat{V}(x) = A J_0(-i x),\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> is a constant. With this result we can now express the total solution as</p>
<div class="math notranslate nohighlight" id="equation-eq-intoscpressuresol">
<span class="eqno">(34)<a class="headerlink" href="#equation-eq-intoscpressuresol" title="Permalink to this equation">¶</a></span>\[  u(r, t) = e^{i\omega t} \left(A I_0(r\sqrt{i\omega/\nu}) +  \frac{K}{i \omega} \right).\]</div>
<p>The boundary condition requires <span class="math notranslate nohighlight">\(u(r_0, t)=0\)</span>, which determines <span class="math notranslate nohighlight">\(A\)</span>:</p>
<div class="math notranslate nohighlight">
\[  A = -\frac{K}{i \omega I_0(r_0 \sqrt{i \omega/ \nu})}.\]</div>
<p>Inserted into <a class="reference internal" href="#equation-eq-intoscpressuresol">(34)</a> we are left with</p>
<div class="math notranslate nohighlight">
\[  u(r, t) = \frac{K e^{i\omega t}}{i \omega} \left( 1 - \frac{I_0(r \sqrt{i \omega})}{I_0(r_0 \sqrt{i \omega/\nu})} \right),\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[  u(r, t) = \frac{K e^{i\omega t}}{i \omega} \left( 1 - \frac{J_0(r \sqrt{-i \omega/\nu})}{J_0(r_0 \sqrt{-i \omega/\nu})} \right),\]</div>
<p>in accordance with Eq. 3-98 in <a class="bibtex reference internal" href="../mandatory/mandatory2.html#white06" id="id4">[Whi06]</a>.</p>
<p>The Bessel function can be found in the toolbox <code class="docutils literal notranslate"><span class="pre">scipy.special</span></code>. The solution is computed below for a relatively large normalized <span class="math notranslate nohighlight">\(\tilde{\omega}=\omega r_0^2/\nu = 10\)</span>. A smaller value of <span class="math notranslate nohighlight">\(\tilde{\omega}\)</span> will result in velocity profiles closer to the steady Poiseuille profile <span class="math notranslate nohighlight">\(u_{max}(1-\tilde{r}^2)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">jv</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="n">r0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">w</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">K</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">nu</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">r0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">w</span><span class="o">*</span><span class="n">r0</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">nu</span>

<span class="k">def</span> <span class="nf">u</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">real</span><span class="p">(</span><span class="n">K</span><span class="o">/</span><span class="mi">1</span><span class="n">j</span><span class="o">/</span><span class="n">w</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">jv</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">r</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">/</span><span class="n">nu</span><span class="p">))</span><span class="o">/</span><span class="n">jv</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">r0</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">w</span><span class="o">/</span><span class="n">nu</span><span class="p">))))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ll</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">w</span><span class="o">*</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">),</span> <span class="n">r</span><span class="p">)</span>
    <span class="c1">#ll += [r&quot;$t = {0}\cdot \tau$&quot;.format(i)]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Velocity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Radial position&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>0.0
10.471975511965978
20.943951023931955
31.415926535897928
41.88790204786391
52.35987755982989
</pre></div>
</div>
<img alt="../../_images/poiseuille_7_1.png" src="../../_images/poiseuille_7_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="suggested-assignments-poiseuille">
<h2>Suggested assignments Poiseuille<a class="headerlink" href="#suggested-assignments-poiseuille" title="Permalink to this headline">¶</a></h2>
<div class="section" id="poiseuille-problems-from-white">
<span id="poiseuille-problems-white"></span><h3>Poiseuille problems from White<a class="headerlink" href="#poiseuille-problems-from-white" title="Permalink to this headline">¶</a></h3>
<p>Problems 3-15, 3-16 and 3-17.</p>
</div>
<div class="section" id="computer-exercise-poiseuille">
<span id="id5"></span><h3>Computer exercise Poiseuille<a class="headerlink" href="#computer-exercise-poiseuille" title="Permalink to this headline">¶</a></h3>
<div class="section" id="verify-analytical-solutions">
<h4>Verify analytical solutions<a class="headerlink" href="#verify-analytical-solutions" title="Permalink to this headline">¶</a></h4>
<p>In <a class="bibtex reference internal" href="../mandatory/mandatory2.html#white06" id="id6">[Whi06]</a> Chap. 3-3.3 there are 6 analytical solutions provided for 6 different types of ducts. Verify the analytical solutions (3-47), (3-49) and (3-52). Experiment with higher order “CG” elements (the solution is then higher order continuous piecewise polynomials) and compute the <code class="docutils literal notranslate"><span class="pre">errornorm</span></code>. Does the error vanish for higher order polynomials for all ducts or does it remain constant?</p>
<p id="bibtex-bibliography-content/chapter3/poiseuille-0"><dl class="citation">
<dt class="bibtex label" id="white06"><span class="brackets">Whi06</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id3">2</a>,<a href="#id4">3</a>,<a href="#id6">4</a>)</span></dt>
<dd><p>Frank M. White. <em>Viscous Fluid Flow</em>. McGraw-Hill, third edition, 2006.</p>
</dd>
</dl>
</p>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "mikaem/MEK4300",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content/chapter3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="couette.html" title="previous page">Couette flows</a>
    <a class='right-next' id="next-link" href="similarity.html" title="next page">Similarity solutions</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Mikael Mortensen<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>